document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("publication-badge-filters");if(!e)return;const t=Array.from(document.querySelectorAll(".bibliography > li")),a=new Map;if(t.forEach(e=>{const t=e.querySelector(".publication-entry");if(!t)return;const l=t.dataset.badge,s=t.dataset.badgeLabel;l&&s&&!a.has(l)&&a.set(l,s)}),0===a.size)return void e.classList.add("unloaded");const l=(e,t,a=!1)=>{const l=document.createElement("button");return l.type="button",l.className="badge-filter",a?(l.classList.add("active"),l.setAttribute("aria-pressed","true")):l.setAttribute("aria-pressed","false"),l.dataset.filter=t,l.textContent=e,l},s=new Set(["Education","Manufacturing","Requirements"]),r=Array.from(a.entries()).filter(e=>s.has(e[1])).sort((e,t)=>e[1].localeCompare(t[1]));e.appendChild(l("All","all",!0)),r.forEach(([t,a])=>{e.appendChild(l(a,t))});const i=t=>{e.querySelectorAll("button.badge-filter").forEach(e=>{const a=e===t;e.classList.toggle("active",a),e.setAttribute("aria-pressed",a?"true":"false")})},o=e=>e.classList.contains("filtered-out")||e.classList.contains("unloaded"),n=()=>{document.querySelectorAll("h2.bibliography").forEach(e=>{e.classList.remove("filtered-out");let t=e.nextElementSibling,a=!0;for(;t&&"H2"!==t.tagName;){if("OL"===t.tagName){const e=t,l=Array.from(e.querySelectorAll(":scope > li"));l.length>0&&l.every(e=>o(e))?(e.classList.add("filtered-out"),e.previousElementSibling&&e.previousElementSibling.classList.add("filtered-out")):(a=!1,e.classList.remove("filtered-out"),e.previousElementSibling&&e.previousElementSibling.classList.remove("filtered-out"))}t=t.nextElementSibling}a&&e.classList.add("filtered-out")})},c=e=>{t.forEach(t=>{const a=t.querySelector(".publication-entry"),l=a?a.dataset.badge:"",s="all"===e||l&&l===e;t.classList.toggle("filtered-out",!s)}),n()};e.addEventListener("click",e=>{const t=e.target.closest("button[data-filter]");t&&(i(t),c(t.dataset.filter))}),c("all")});